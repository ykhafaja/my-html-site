<form id="employeeForm" onsubmit="submitEmployeeData(); return false;">
  <label>Employee Number: <input type="text" name="empNumber" required></label><br>
  <label>Name: <input type="text" name="name" required></label><br>
  <label>Date of Birth: <input type="date" name="dateOfBirth"></label><br>
  <label>Gender: <input type="text" name="gender"></label><br>
  <label>Civil ID No: <input type="text" name="civilId"></label><br>
  <label>Nationality: <input type="text" name="nationality"></label><br>
  <label>Marital Status: <input type="text" name="maritalStatus"></label><br>
  <label>Passport No: <input type="text" name="passportNo"></label><br>
  <label>Place of Issue: <input type="text" name="placeOfIssue"></label><br>
  <label>Date of Issue: <input type="date" name="dateOfIssue"></label><br>
  <label>Valid Till (Passport): <input type="date" name="validTillPassport"></label><br>
  <label>Valid Till (Civil ID): <input type="date" name="validTillCivilId"></label><br>

  <button type="submit">Submit</button>
</form>

<script>
  async function submitEmployeeData() {
    const form = document.getElementById('employeeForm');
    const data = {
      empNumber: form.empNumber.value,
      name: form.name.value,
      dateOfBirth: form.dateOfBirth.value,
      gender: form.gender.value,
      civilId: form.civilId.value,
      nationality: form.nationality.value,
      maritalStatus: form.maritalStatus.value,
      passportNo: form.passportNo.value,
      placeOfIssue: form.placeOfIssue.value,
      dateOfIssue: form.dateOfIssue.value,
      validTillPassport: form.validTillPassport.value,
      validTillCivilId: form.validTillCivilId.value
    };

    const scriptURL = 'https://script.google.com/macros/s/AKfycbxuNtkSa1cwcWeyu7qSx7ZfODNVrCjZm5Hx7T9_eWgH0NtmTqmtm7zlTVo_tOzFpihV/exec';

    try {
      const response = await fetch(scriptURL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data),
      });

      const result = await response.json();
      alert(result.message);
    } catch (error) {
      console.error("Failed to submit data:", error);
      alert("Failed to submit data. Check the console for details.");
    }
  }
</script>
